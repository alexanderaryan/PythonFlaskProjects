<!doctype html>
<html>
<head>
  <meta charset="utf-8">
    <title >Milk Ledger</title>

     <!-- For the bootstrap cdn and basic bootstrap js !-->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>


    <!--  For custom css -->
      <link href="/static/css/invoice_weasy.css" rel="stylesheet">

    <!--    For font awesome items-->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.0/css/all.css" integrity="sha384-lZN37f5QGtY3VHgisS14W3ExzMWZxybE1SJSEsQp9S+oqd12jhcu+A56Ebc1zFSJ" crossorigin="anonymous">

</head>

<body>
<input onclick="lang_func()" type="checkbox" style="display:None;" id="langbtn">
<center>
    <table>
        <tr>
            <td>
                <button class="btn btn-primary hidden-print" onclick="myFunction()">
        <i class="fa fa-print" aria-hidden="true"></i> Print</button>
            </td>
            <td>

            </td>
            <td>
              <a href="javascript:history.back()" class="btn btn-secondary en " id="back-button_en">Back</a>
            </td>
                <td>
                    <a href="javascript:history.back()" class="btn btn-secondary tn "  id="back-button_tn">பின் செல்</a>
                </td>
        </tr>
                </table>
	    </center>


{% for name,data in per_user_bill.items() %}
            {% for cust in customer_set %}
                {% if cust.owner_id == name %}
            <div class="invoice-box" id="bill" >
              <table cellpadding="0" cellspacing="0">
                <tr class="top">
                  <td colspan="2">
                    <table>
                      <header class="clearfix">
                      <tr>

                       <div class="row">
                            <div class="col-sm">
                            <td></td>

                            </div>
                            <div class="col-sm">
                            <td class="title text-center">
                            <img src="/static/images/default_cust.jpg" style="height: 100px;">
                             </td>
                            </div>
                            <div class="col-sm">
                            <td></td>
                            </div>
                          </div>

                       </header>
                      </tr>
                      <tr>
                        <header class="clearfix">
                          <h1 class="text-uppercase text-center mb-5 ">{{cust.owner_id}}</h1>
                        </header>
                      </tr>

                      <tr>
                        <td>

                        </td>
                        <td>
                          Invoice #: {{invoice_number}}<br>
                          Created: {{date}}<br>
          <!--                Due: {{duedate}}-->
                        </td>
                      </tr>
                    </table>
                  </td>
                </tr>

                <tr class="information">
                  <td colspan="2">
                    <table>
                      <tr>
                        <td>
                          {{from_addr['company_name']}}<br>
                          {{from_addr['addr1']}}<br>
                          {{from_addr['addr2']}}
                        </td>
                        <td>
                          {{cust.name}}<br>
                          {{cust.place}}<br>
                          {% if cust.phone_number %}
                          {{cust.phone_number}}<br>
                          {% endif %}
                          {% if cust.email %}
                          {{cust.email}}<br>
                          {% endif %}
                        </td>
                      </tr>
                    </table>
                  </td>
                </tr>
              </table>
              <table>
                <tr class="heading">
                  {% for col_no in range(header|length) %}
                <td scope="col" class="thead-dark en">
                  {{ header[col_no] }}
                </td>
                {% endfor %}
              </tr>
              <tr class="heading">
                  {% for col_no in range(header|length) %}
                <td scope="col" class="thead-dark tn">
                  {{ tm_header[col_no] }}
                </td>
                {% endfor %}

                </tr>


               {% for d in data['milk_data'] %}
          <tr class="item">
            <td>{{d.milked_date.strftime('%Y-%m-%d') }}</td>
            <td>{{d.am_litre }}</td>
            <td>{{d.pm_litre}}</td>
              {% set price = (d.am_litre + d.pm_litre) * d.price %}
            <td>{{d.fodder}}</td>
              <td>{{d.loan}}</td>
              <td>{{d.advance}}</td>
              <td>{{d.dr_service}}</td>
            <td>{{"%.2f" | format(price) }}</td>
            </td>
          </tr>
        {% endfor %}
          <tr class="item">
            <td class="en">Total</td>
            <td class="tn">மொத்தம்</td>
            <td>{{data['am']}}</td>
            <td>{{data['pm']}}</td>
            <td>{{data['fodder']}}</td>
            <td>{{data['loan']}}</td>
            <td>{{data['advance']}}</td>
            <td>{{data['dr_service']}}</td>
            <td>{{data['total']}}</td>
        </tr>
                 <tr class="item">
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td class="en">Fodder</td>
            <td class="tn">தீவனம்</td>
            <td>{{data['fodder']}}</td>
        </tr>
         <tr class="item">
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td class="en">Loan</td>
            <td class="tn">கடன்</td>
            <td>{{data['loan']}}</td>
        </tr>
         <tr class="item">
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td class="en">Advance</td>
            <td class="tn">முன்பணம்</td>
            <td>{{data['advance']}}</td>
        </tr>
         <tr class="item">
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td class="en">Dr_Service</td>
            <td class="tn">மருத்துவச் செலவு</td>
            <td>{{data['dr_service']}}</td>
        </tr>
        <tr class="item">
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td class="en">Milking Charge</td>
            <td class="tn">கறவைக்காசு</td>
            <td>{{milking_charge}}</td>
        </tr>
        <tr class="total">
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td class="en"></td>
            <td class="tn"></td>
            <td >{{"%.2f" | format(data['total'] -
                data['fodder'] -
                data['loan'] -
                data['advance'] -
                data['dr_service'] -
                milking_charge)}}</td>
        </tr>

              </table>

              <div id="notices">
                  <div class="en">NOTICE:</div>
                    <div class="tn">அறிவிப்பு:</div>
                  <div class="notice en">Total bill due is deducted with sum of fodder, loan, advance, milking charge and doctor service. </div>
                    <div class="notice tn">தீவனம், கடன், முன்பணம், பால் கறக்கும் கட்டணம் மற்றும் மருத்துவர் சேவை ஆகியவற்றுடன் நிலுவையில் உள்ள மொத்த பில் கழிக்கப்படுகிறது.</div>
                </div>
<div class="divFooter"></div>
            </div>

      {% endif %}


  {% endfor %}
  {% endfor %}


<!--  #################################-->


<script>


//To Print Function


function myFunction() {
    var print_button = document.getElementsByClassName("hidden-print");
    var en_lang_button = document.getElementById("back-button_en");
    var tn_lang_button = document.getElementById("back-button_tn");
    console.log(en_lang_button.style.display);
    if (en_lang_button.style.display == 'none'){
        console.log("En is none")
        lang_button=en_lang_button;
        miss_button=tn_lang_button;
    }
    else{
        lang_button=tn_lang_button;
        miss_button=en_lang_button;
    }
    for (var i=0;i<print_button.length;i+=1){
      print_button[i].style.display = 'none';
    }
    miss_button.style.display = 'none';
    window.print();
    var print_button = document.getElementsByClassName("hidden-print");
    for (var i=0;i<print_button.length;i+=1){
      print_button[i].style.display = 'inherit';
    }
    lang_button.style.display="none"
    miss_button.style.display = 'inherit';

}


//To handle language


function lang_func() {

    //document.getElementById("langbtn").checked = checked;

    var checkbox = document.getElementById("langbtn");
    check = checkbox.checked;

    //console.log("check func called"+check);

    //debugger;
    localStorage.setItem("langbtn", checkbox.checked=check);
    if (check) {

    for (let el of document.querySelectorAll('.en'))
         el.style.display='none';
         document.title = 'Milk Ledger';
    for (let el of document.querySelectorAll('.tn'))
        el.style.display='revert';
        document.title = 'பால் கணக்கு';
    //document.getElementsByClassName("btn-primary")
    for (let el of document.querySelectorAll('.btn-primary')){
        el.style.backgroundColor="#2ab934";
        el.style.borderColor="#2ab934";
        }
     for (let el of document.querySelectorAll("#link")){
        el.style.color="#2ab934";
        }
     for (let el of document.querySelectorAll('.btn-primary, .btn-rounded')){
        el.style.backgroundColor="#2ab934";
        el.style.borderColor="#2ab934";
        }

    for (let el of document.querySelectorAll('.btn-outline-primary')){
        el.style.borderColor="#2ab934";
        el.style.color="#2ab934";
        }
    for (let el of document.querySelectorAll('.form-control')){
        el.style.borderColor="#2ab934";
        }
    for (let el of document.querySelectorAll('.btn-primary.tn, .dropdown-item.tn'))
        el.style.display='flow-root';

    }
    else{
    for (let el of document.querySelectorAll('.tn'))
        el.style.display='none';
        document.title = 'பால் கணக்கு';
    for (let el of document.querySelectorAll('.en'))
        el.style.display='revert';
        document.title = 'Milk Ledger';


    for (let el of document.querySelectorAll('.btn-primary, .btn-rounded')){
        el.style.backgroundColor="#007bff";
        el.style.borderColor="#007bff";
        }

    for (let el of document.querySelectorAll('.btn-outline-primary')){
        el.style.borderColor="#007bff";
        el.style.color="#007bff";
        }

      for (let el of document.querySelectorAll("#link")){
        el.style.color="#007bff";
        }

   for (let el of document.querySelectorAll('.form-control')){
        el.style.borderColor="#007bff";
        }
    for (let el of document.querySelectorAll('.btn-primary.en, .dropdown-item.en'))
        el.style.display='flow-root';
}
}

var checked = JSON.parse(localStorage.getItem("langbtn"));
document.getElementById("langbtn").checked = checked;
lang_func()

</script>
</body>
</html>