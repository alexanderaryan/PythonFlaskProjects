{% extends "base.html" %}
{% block content %}

{% with messages = get_flashed_messages()%}
        {% if messages %}
        {% for mess in messages%}

        <div class="alert alert-warning alert-dismissible fade show" role="alert">
      <strong>{{error}}</strong>  {{ mess }}
      <button type="button" class="close" data-dismiss="alert" aria-label="Close">
        <span aria-hidden="true">&times;</span>
      </button>
    </div>


        {% endfor %}
    {% endif %}
    {% endwith %}


<section style="background-size: cover;background-repeat: no-repeat;background-image: url('https://images.unsplash.com/photo-1596733430284-f7437764b1a9?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=870&q=80');">

      <div class="row d-flex justify-content-center align-items-center h-100">
          <form class="card" method="POST" style="border-radius: 15px;">
            <div class="card-body p-5">
              <h2 class="text-uppercase text-center mb-5 en">View/Update Customer List</h2>
              <h2 class="text-uppercase text-center mb-5 tn">வாடிக்கையாளர் பட்டியலைப் பார்க்க/புதுப்பிக்க</h2>
                {{form.hidden_tag()}}
  <div class="table-responsive" >
  <table class="table table-striped" id="sortTable">

  <thead>
    <tr>
      {% for col_no in range(header|length) %}
      <th scope="col" class="thead-dark en">
        {{ header[col_no] }}
      </th>
      {% endfor %}
    </tr>
  {% for col_no in range(header|length) %}
      <th scope="col" class="thead-dark tn">
        {{ tm_header[col_no] }}
      </th>
      {% endfor %}
    </tr>
  </thead>
     <tbody>

     {% for values in owner_list%}
     {% if values.surname %}
     {% set fullname = values.name+' '+ values.surname %}
                  {% else %}
                {% set fullname = values.name%}
                  {% endif %}
     <tr>
        <td>{{form.checkbox(value=(values.id | string) +':'+ (values.owner_id | string))}}</td>
        <td><a href="" id="link" data-toggle="modal" data-target="#modalLoginAvatar-{{values.owner_id}}">
                 {{values.owner_id}}</a>
             </td>

        <!--Modal: Login with Avatar Form-->
        <div class="modal fade" id="modalLoginAvatar-{{values.owner_id}}" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
          aria-hidden="true">
          <div class="modal-dialog cascading-modal modal-avatar modal-sm" role="document">
            <!--Content-->
            <div class="modal-content">

              <!--Header-->
              <div class="modal-header">
                <img src="{{url_for('static', filename='profile_pics/' + values.profile_pic_name)
                 if values.profile_pic_name
                         else '/static/images/default_cust.jpg'}}" alt="avatar" width=100%; class="rounded-circle img-responsive">
              </div>
              <!--Body-->
              <div class="modal-body text-center mb-1">
                <div class="md-form ml-0 mr-0">
                     <div class="d-flex flex-column align-items-center text-center p-3 py-5">
            <div class="ml-3 w-100">
                <h4 class="mb-0 mt-0">
                    {{values.name}}
                    {% if values.surname %}
                    {{values.surname}}
                    {% endif %}
                </h4>
                <span class="font-weight-bold">
                        {% if values.phone_number %}
                    {{values.phone_number}}
                    {% endif %}

                </span><br>
                <span class="font-weight-bold">
                {% if values.place %}
                    {{values.place}}
                    {% endif %}
                </span>
                <hr>
                 <h4 class="mb-0 mt-0"><label class="form-label en" >Milkers</label>
            <label class="form-label tn" >கறவைக்காரர்கள்</label><br></h4>
        {% if values.milker_list() %}
            {% for milker in values.milker_list() %}
        <span class="font-weight-bold">
                {{milker.name}}
            </span><br>
            {% endfor %}
        {% else %}
            {{"No Milkers Linked to customer"}}
        {% endif %}

<hr>
                <div class="p-2 mt-2 bg-primary d-flex rounded text-white stats" style="justify-content:space-around;">
                    <div class="d-flex flex-column">
                        <span class="en articles">Cows</span>
                        <span class="tn articles">மாடுகள் எண்ணிக்கை</span>
                        <span class="number1">{{values.cows}}</span>
                    </div>

                    <div class="d-flex flex-column">
                        <span class="en followers">KCC Loan</span>
                        <span class="tn followers">கேசிசி லோன்</span>
                        <span class="number2">{{values.kcc_loan if values.kcc_loan else 0}}</span>
                    </div>

                    <div class="d-flex flex-column">
                        <span class="en rating">Dairy Loan</span>
                        <span class="tn rating">டைரி லோன்</span>
                        <span class="number3">{{values.dairy_loan if values.dairy_loan else 0}}</span>
                    </div>

                </div>
                <div class="button mt-2 d-flex flex-row align-items-center">
                    <a href="{{url_for('owner.liab_own',own_id=values.owner_id)}}"
                            class="en btn-sm btn-primary w-100 ml-2">EDIT</a>
                    <a href="{{url_for('owner.liab_own',own_id=values.owner_id)}}"
                            class="tn btn-sm btn-primary w-100 ml-2">திருத்து</a>
                </div>
            </div>
                {% if values.email is not none  %}
                <span class="text-black-50">{{values.email}}</span><span> </span></div>
                {% else %}
                <span class="text-black-50">email@example.com</span><span> </span>
                    {% endif %}
<!--                  <input type="password" type="text" id="form29" class="form-control form-control-sm validate ml-0">-->
<!--                  <label data-error="wrong" data-success="right" for="form29" class="ml-0">Enter password</label>-->

                </div>

              </div>

            </div>
            <!--/.Content-->
          </div>
        </div>

         {% if values.surname %}
     {% set fullname = values.name+' '+ values.surname %}
                  {% else %}
                {% set fullname = values.name%}
                  {% endif %}
         <td>{{ fullname }}</td>
         <td>{{ values.place }}</td>
         <td>{{ values.cows }}</td>
         <td>{{ values.milker_id }}</td>
         <td>{{ values.active }}</td>
       </tr>
    {% endfor %}
  </table>
</div>
    <div class="d-flex justify-content-center">
                  {{form.submit(class="btn btn-success btn-block btn-lg gradient-custom-4 text-body en justify-content-center")}}
                    {{form.submit(class="btn btn-success btn-block btn-lg gradient-custom-4 text-body tn justify-content-center",value="புதுப்பி")}}
                </div><br>
        <div class="d-flex justify-content-center">
    <a href="{{ url_for('core.index') }}" class="btn btn-secondary en">Cancel</a>
                </div>
        <div class="d-flex justify-content-center">
    <a href="{{ url_for('core.index') }}" class="btn btn-secondary tn">ரத்து செய்</a>
                </div>
            </div>
          </form>
      </div>
</section>


{% endblock %}
