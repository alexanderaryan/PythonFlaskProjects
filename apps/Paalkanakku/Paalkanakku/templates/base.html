<!DOCTYPE html>
<html lang="en">
<head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <meta charset="UTF-8">

    <title>பால் கணக்கு</title>

    <!-- For the bootstrap cdn and basic bootstrap js !-->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

<!--    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>-->
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>

    <!-- For datatables !-->
    <script src="https://cdn.datatables.net/1.10.22/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.10.22/js/dataTables.bootstrap4.min.js"></script>

    <!--   Importing customized CSS -->
    <link href="/static/css/milk_common.css" rel="stylesheet">
    <link href="/static/css/user_profile.css" rel="stylesheet">

    <!--    Google Transliterate-->
    <script type="text/javascript" src="/static/js/tamil_trans.js"></script>
    <!--    Profile Pic -->
    <script type="text/javascript" src="/static/js/profile_pic.js"></script>

</head>

<body style = "background-color: lavender;">


<!--New Navbar-->

    <nav class="navbar navbar-dark bg-dark navbar-expand-lg justify-content-between mt-3">
  <button class="navbar-toggler order-2" type="button" data-toggle="collapse" data-target="#navbar-list-9" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

    <div class="collapse navbar-collapse w-100 order-3 order-lg-1" id="navbar-list-9">


        <div class="right-side d-flex" style="justify-content: right;">
            <ul class="navbar-nav">
 <label class="switch nav-item ">
 <input onclick="lang_func()" type="checkbox" id="langbtn">
 <div class="slider round">
  <!--ADDED HTML -->
  <span class="on">தமிழ்</span>
  <span class="off">Eng</span>
  <!--END-->
 </div>

</label>
                </ul>
</div>

                  {% if current_user.is_authenticated %}
      <hr class="d-block d-md-none">
      <ul class="navbar-nav">
          <li class="nav-item dropdown">
          <a id="link" class="nav-link dropdown-toggle en" href="#" id="navbarDropdownMenuLink" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            Customers
          </a>
          <a id="link" class="nav-link dropdown-toggle tn" href="#" id="navbarDropdownMenuLink" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            வாடிக்கையாளர்கள்
          </a>
          <div class="dropdown-menu" id="dd_items" aria-labelledby="navbarDropdownMenuLink">
            <a class="dropdown-item en" href="{{url_for('owner.add_own')}}">Add</a>
              <a class="dropdown-item tn" href="{{url_for('owner.add_own')}}">சேர்</a>
            <a class="dropdown-item en" href="{{url_for('owner.list_own')}}">View</a>
              <a class="dropdown-item tn" href="{{url_for('owner.list_own')}}">பார்க்க</a>
          </div>
        </li>
      </ul>
<hr class="d-block d-md-none">

      <ul class="navbar-nav">
        <li class="nav-item dropdown">
        <a id="link" class="nav-link dropdown-toggle en" href="#" id="navbarDropdownMenuLink" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            Milkers
        </a>
            <a id="link" class="nav-link dropdown-toggle tn" href="#" id="navbarDropdownMenuLink" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            கறவைக்காரர்கள்
        </a>
        <div class="dropdown-menu" id="dd_items" aria-labelledby="navbarDropdownMenuLink">
            <a class="dropdown-item en" href="{{url_for('milker.add_milker')}}">Add</a>
            <a class="dropdown-item tn" href="{{url_for('milker.add_milker')}}">சேர்</a>
            <a class="dropdown-item en" href="{{url_for('milker.list_milker')}}">View</a>
            <a class="dropdown-item tn" href="{{url_for('milker.list_milker')}}">பார்க்க</a>
        </div>
        </li>
      </ul>
<hr class="d-block d-md-none">


      <ul class="navbar-nav">
        <li class="nav-item dropdown">
        <a id="link" class="nav-link dropdown-toggle en" href="#" id="navbarDropdownMenuLink" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
        MilkLedger
        </a>
            <a id="link" class="nav-link dropdown-toggle tn" href="#" id="navbarDropdownMenuLink" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
        பால்கணக்கு
        </a>
        <div class="dropdown-menu" id="dd_items" aria-labelledby="navbarDropdownMenuLink">
            <a class="dropdown-item en" href="{{url_for('milk.add_daily_data',modified_day='None', milked_time='None')}}">Add</a>
            <a class="dropdown-item tn" href="{{url_for('milk.add_daily_data',modified_day='None', milked_time='None')}}">சேர்</a>
            <a class="dropdown-item en" href="{{url_for('milk.milk_ledger_view',month='None' )}}">View</a>
            <a class="dropdown-item tn" href="{{url_for('milk.milk_ledger_view',month='None' )}}">பார்க்க</a>
        </div>
        </li>
      </ul>

<hr class="d-block d-md-none">
        {% else %}

        <hr id="hr_logo" class="d-block d-md-none" style="border-top: 10px solid #007bff;">
        <div class="collapse navbar-collapse w-100 order-3 order-lg-1" id="navbar-list-9">
    <ul class="navbar-nav">
      <li class="nav-item active">
         <a type="button"  class="nav-link btn btn-primary me-3 en" href="{{url_for('users.login')}}">Log in</a>
          <a type="button" class="nav-link btn btn-primary me-3 tn" href="{{url_for('users.login')}}">உள்நுழை</a>
      </li>
        <hr>
      <li class="nav-item active">
          <a type="button" class="nav-link btn btn-primary me-3 en" href="{{url_for('users.register')}}">Register</a>
          <a type="button" class="nav-link btn btn-primary me-3 tn" href="{{url_for('users.register')}}">பதிவு செய்</a>
      </li>

    </ul>
  </div>

        {% endif %}
</div>
  <a class="navbar-brand mx-lg-0 order-1 order-lg-2 me-2 logo" href="{{url_for('core.index')}}">
    <img id="img_logo" src="/static/images/Paalkanakku-logos.jpeg" width="60" height="60" alt="logo">
    <b>Milk<span id="font_logo">Ledger</span></b>
  </a>
        {% if current_user.is_authenticated %}
          <ul class="navbar-nav mx-lg-0 order-1 order-lg-2 me-2 logo">
          <li class="nav-item " style="display: flex;">
    <input type="search" id="form1" class="form-control" readonly placeholder={{ milk_price() }} aria-label="Search" />
    <input type="button" class="btn btn-primary en" readonly maxlength="4" value="MilkRate">
              <input type="button" class="btn btn-primary tn" readonly value="பால் விலை">
          </li>
          </ul>



  <div class="collapse navbar-collapse justify-content-end order-3" id="navbar-list-9">
      <hr id="hr_logo"  class="d-block d-md-none"  style="border-top: 10px solid #007bff;">
          <li class="nav-item dropdown" style="list-style-type: none;">
          <a id="link" class="nav-link dropdown-toggle" href="#" id="navbarDropdownMenuLink" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            <img src="{{url_for('static',filename='profile_pics/'+current_user.profile_image)}}" width="40" height="40" class="rounded-circle">
          </a>
          <div class="dropdown-menu" id="dd_items" aria-labelledby="navbarDropdownMenuLink">
            <a class="dropdown-item en" href="{{url_for('users.logout')}}">Log out</a>
              <a class="dropdown-item tn" href="{{url_for('users.logout')}}">வெளியேறு</a>
            <a class="dropdown-item en"  href="{{url_for('users.account')}}">Edit Profile</a>
              <a class="dropdown-item tn"  href="{{url_for('users.account')}}">சுயவிவரத்தை திருத்த</a>

          </div>
        </li>

      </ul>
  </div>
        {% endif %}
</nav>


    <div class="container-fluid">

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<div id="preloader">
  <div class="loader">
    <p class="loader_text" id="loader_text"><span class="loader_text_unit" data-count="100">0</span><span>%</span></p>
    <div class="loader_bar" id="loader_bar"></div>
  </div>
</div>
        {% block content%}

        {% endblock %}
    </div>

<script>


//To show the progress of the page loading
$(window).on('load', function() {
//debugger;
  $('#preloader').css({
    "transform": "translateY(-100%)",
    "transition-delay": "0.6s"
  });
  $('.loader').css({
    "opacity": "0",
    "transform": "translate(-50%,-100%)",
    "transition-delay": "0.3s"
  });

  $('.loader_text_unit').each(function() {
    var $this = $(this),
        countTo = $this.attr('data-count');

    $({ countNum: $this.text()}).animate({
      countNum: countTo
    },

    {

      duration: 300,
      easing:'linear',
      step: function() {
        $this.text(Math.floor(this.countNum));
      },
      complete: function() {
        $this.text(this.countNum);
      }
    });
  });

});



//To handle language


function lang_func() {

    //document.getElementById("langbtn").checked = checked;

    var checkbox = document.getElementById("langbtn");
    check = checkbox.checked;

    console.log("check func called"+check);

    //debugger;
    localStorage.setItem("langbtn", checkbox.checked=check);
    if (check) {

    for (let el of document.querySelectorAll('.en'))
         el.style.display='none';
    for (let el of document.querySelectorAll('.tn'))
        el.style.display='revert';
    document.getElementById("img_logo").src = "/static/images/Paalkanakku-logos_green.jpeg";
    document.getElementById("font_logo").style.color="#2ab934";
    document.getElementById("font_logo").style.border="solid #2ab934";
    document.getElementById("hr_logo").style.borderTop= "10px solid #2ab934";
    //document.getElementsByClassName("btn-primary")
    for (let el of document.querySelectorAll('.btn-primary')){
        el.style.backgroundColor="#2ab934";
        el.style.borderColor="#2ab934";
        }
     for (let el of document.querySelectorAll("#link")){
        el.style.color="#2ab934";
        }
     for (let el of document.querySelectorAll('.btn-primary, .btn-rounded')){
        el.style.backgroundColor="#2ab934";
        el.style.borderColor="#2ab934";
        }

    for (let el of document.querySelectorAll('.btn-outline-primary')){
        el.style.borderColor="#2ab934";
        el.style.color="#2ab934";
        }
    for (let el of document.querySelectorAll('.form-control')){
        el.style.borderColor="#2ab934";
        }
    for (let el of document.querySelectorAll('.btn-primary.tn, .dropdown-item.tn'))
        el.style.display='flow-root';

    }
    else{
    for (let el of document.querySelectorAll('.tn'))
        el.style.display='none';
    for (let el of document.querySelectorAll('.en'))
        el.style.display='revert';
    document.getElementById("img_logo").src = "/static/images/Paalkanakku-logos.jpeg";
    document.getElementById("font_logo").style.color="#007bff";
    document.getElementById("font_logo").style.border="solid #007bff";
    document.getElementById("hr_logo").style.borderTop= "10px solid #007bff";


    for (let el of document.querySelectorAll('.btn-primary, .btn-rounded')){
        el.style.backgroundColor="#007bff";
        el.style.borderColor="#007bff";
        }

    for (let el of document.querySelectorAll('.btn-outline-primary')){
        el.style.borderColor="#007bff";
        el.style.color="#007bff";
        }

      for (let el of document.querySelectorAll("#link")){
        el.style.color="#007bff";
        }

   for (let el of document.querySelectorAll('.form-control')){
        el.style.borderColor="#007bff";
        }
    for (let el of document.querySelectorAll('.btn-primary.en, .dropdown-item.en'))
        el.style.display='flow-root';
}
}

var checked = JSON.parse(localStorage.getItem("langbtn"));
document.getElementById("langbtn").checked = checked;
lang_func()

//To set id for multiple elements in add daily page
polls = document.querySelectorAll('[id ^= "daily_data-"]');
Array.prototype.forEach.call(polls, callback);

function callback(element, iterator) {
    //console.log(element.id);
    //debugger;
    document.getElementById(element.id).setAttribute("name",element.id);
}


//Function to handle default milked date and time
function handler(e){
  //time = document.getElementsByName("milked_time");
  time = document.querySelector('input[name="milked_time"]:checked').value;

  console.log(time);
  date=document.getElementById("milked_date").value;
  console.log(date);
  debugger;
  location.href = "{{url_for('milk.add_daily_data', modified_day = 'date',milked_time='mt')}}".replace('date',date).replace('mt',time);
  //location.href = Flask.url_for('milk.add_daily_data'', {modified_day: e.target.value});
}

//Function to handle default month
function month_handler(e){
  //time = document.getElementsByName("milked_time");
  //time = document.querySelector('input[name="milked_time"]:checked').value;

  //console.log(time);
  month=document.getElementById("milkmonth").value+'-01';
  console.log(month);
  ////debugger;
  location.href = "{{url_for('milk.milk_ledger_view', month = 'month')}}".replace('month',month);
  //location.href = Flask.url_for('milk.add_daily_data'', {modified_day: e.target.value});
}


//To handle active and inactive milkers
milker_id = document.querySelectorAll('[id $= "milker"]');
Array.prototype.forEach.call(milker_id, milker_id_change);

function milker_id_change(element, iterator) {
    console.log(element.attributes.option.nodeValue);
    console.log(element.attributes);
    //debugger;
    console.log(element.attributes.option);
    $(element).val(element.attributes.option.nodeValue);
}


//To handle 3 digit millilitres
ml_id = document.querySelectorAll('[id $= "-ml"]');
Array.prototype.forEach.call(ml_id, ml_id_change);

function ml_id_change(element, iterator) {
    console.log(element.attributes.value.nodeValue);
    console.log(pad(element.attributes.value.nodeValue,3));
    function pad(num, size) {
    num = num.toString();
    console.log(num);
    while (num.length < size) num = num+"0";
    console.log(num);
    return num;
    }
    //debugger;
    $(element).val(pad(element.attributes.value.nodeValue,3));
}


////Function to check the default milked time AM/PM
milked_time = document.querySelectorAll('[name ^= "milked_time"]');
Array.prototype.forEach.call(milked_time, milked_time_change);

function milked_time_change(element, iterator) {

    var host = window.location.href;
    console.log(window.location.href,window.location.href.slice(-2));
    if (host.slice(-2) == "pm" ){
        document.getElementById('milked_time-1').checked = true;
    }
    ////debugger;
}


//To trasnlate the form elements to Tamil
    google.load("elements", "1", {
        packages: "transliteration"
    });
    function onLoad() {
        var options = {
            sourceLanguage: 'en',
            destinationLanguage: ['ta'],
            shortcutKey: 'ctrl+g',
            transliterationEnabled: true
        };
        var control =
            new google.elements.transliteration.TransliterationControl(options);
        //var ids = ["MainContent_myarea","MainContent","trans"];
        var ids = document.querySelectorAll('[id = "trans" ]');

        control.makeTransliteratable(ids);
        //control.showControl('container');
    }
    google.setOnLoadCallback(onLoad);



</script>

</body>
</html>